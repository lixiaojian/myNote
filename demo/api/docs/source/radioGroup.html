<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js"><span id='global-property-'>/**
</span> * @ignore
 * Created by xiaojianli@pptv.com on 2015/7/13.
 *
 * 适用于组  根据name分组
 */
;(function(){
    var doc = document,
        addDomEvent = UTIL.addDomEvent,
        fixedEvent = UTIL.fixedEvent,
        addClass = UTIL.dom.addClass,
        removeClass = UTIL.dom.removeClass,
        filterElemByClass = UTIL.dom.filterElemByClass,
        filterElemByAttrVal = UTIL.dom.filterElemByAttrVal;

<span id='PDIKit-form-RadioGroup-cfg-name'><span id='PDIKit-form-RadioGroup-cfg-checkedVal'><span id='PDIKit-form-RadioGroup-cfg-parentElement'><span id='PDIKit-form-RadioGroup'>    /**
</span></span></span></span>     * &lt;h2&gt;单选框组件&lt;/h2&gt;
     * 对外暴露为：PDIKit.form.RadioGroup&lt;br&gt;
     *    &amp;nbsp;&amp;nbsp;&amp;nbsp;&amp;nbsp;初始化示例:
     *    &lt;pre&gt;
     *    var radio = new PDIKit.form.RadioGroup({
     *          parentElement:document.getElementById(&#39;radioBox&#39;),
     *          name:&#39;radios&#39;,
     *          checkedVal:&#39;val&#39;
     *     });
     *    &lt;/pre&gt;
     *
     * @class PDIKit.form.RadioGroup
     * @cfg {String} parentElement
     * 需要初始化组件的父节点
     * @cfg {String} checkedVal
     * 被选中时的值
     * @cfg {String} name
     * 单选框组的name值
     *
     */
    var RadioGroup = function(opt){
        this.parentElement = opt.parentElement || null;
        this.name = opt.name;
        this.checkedVal=opt.checkedVal || null;
        this.inputs = [];
        this.init();
    };
<span id='PDIKit-form-RadioGroup-method-initComps'>    /**
</span>     * @method
     *  内部调用的方法  用于初始化插件的骨架
     * @private
     * @param {Function}cb  回调方法
     */
    var initComps = function(cb){
        var p = this.parentElement;
        var name = this.name;
        var val = this.checkedVal;
        if(!p || !name) return;
        var inputs=[];
        var ras = filterElemByAttrVal(p, &#39;input&#39;, &#39;name&#39;, name);
        for(var i=0;i&lt;ras.length;i++){
            var input = ras[i];
            if(input.type.toLowerCase() === &#39;radio&#39;){
                //标记radio的父级元素
                addClass(input.parentElement,&#39;radio-parent&#39;);
                addClass(input,&#39;hidden&#39;);
                (function(r){
                    //如果设置了选中值就以设置的为准，如果没有设置就从input中取
                    if(r.checked){
                        val = val || r.value;
                    };
                    var label = doc.createElement(&#39;a&#39;);
                    label.href=&#39;javascript:void(0);&#39;;
                    label.className=&#39;definition-radio&#39;;
                    if(val &amp;&amp; r.value === val){
                        r.checked = true;
                        label.className=&#39;definition-radio checked&#39;;
                    }
                    inputs.push(r);
                    r.parentNode.insertBefore(label,r);
                }(input));
            }
        }
        this.inputs = inputs;
    };
<span id='PDIKit-form-RadioGroup-method-initEvent'>    /**
</span>     * @method
     *  内部调用的方法  用于初始化插件的事件
     * @private
     */
    var initEvent = function(){
        var rao = this;
        var p = this.parentElement;
        var name = this.name;
        var inputs = this.inputs;
        if(!p || !name) return;
        var radioparents = filterElemByClass(p,&#39;span&#39;,&#39;radio-parent&#39;);
        for(var index in radioparents){
            var rp = radioparents[index];
            addDomEvent(rp,&#39;click&#39;,function(e){
                var input = filterElemByAttrVal(this,&#39;input&#39;,&#39;name&#39;,name)[0];
                if(input){
                    rao.setValue(input.value);
                }
            })
        };
    };
    //添加初始化方法
    RadioGroup.prototype = {
        init: function(cb){
            initComps.call(this);
            initEvent.call(this);
        },
<span id='PDIKit-form-RadioGroup-method-getValue'>        /**
</span>         * @method
         * 获取被选中的值
         * @return {Object} value
         */
        getValue : function(){
            for(var i=0;i&lt;this.inputs.length;i++){
                if(this.inputs[i].checked){
                    return this.inputs[i].value;
                }
            }
        },
<span id='PDIKit-form-RadioGroup-method-setValue'>        /**
</span>         * @method
         * 设置值
         * @param {String}value
         */
        setValue : function(value){
            var inputs = this.inputs;
            for(var i=0;i&lt;inputs.length;i++){
                removeClass(inputs[i].previousSibling,&#39;checked&#39;);
                if(inputs[i].value === value+&quot;&quot;){
                    inputs[i].click();
                    inputs[i].checked = true;
                    addClass(inputs[i].previousSibling,&#39;checked&#39;);
                }
            }
        },
<span id='PDIKit-form-RadioGroup-method-reload'>        /**
</span>         * @method
         * 刷新组件
         */
        reload : function(){
            var inputs = this.inputs;
            for(var i=0;i&lt;inputs.length;i++){
                removeClass(inputs[i].previousSibling,&#39;checked&#39;);
                if(inputs[i].checked){
                    addClass(inputs[i].previousSibling,&#39;checked&#39;);
                }
            }
        }
    };
    window.PDIKit = window.PDIKit || {};
    window.PDIKit.form = window.PDIKit.form ||{};
    window.PDIKit.form.RadioGroup = window.PDIKit.form.RadioGroup || RadioGroup;
}());</pre>
</body>
</html>
